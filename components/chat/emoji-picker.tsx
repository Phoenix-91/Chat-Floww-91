"use client"

import { useState } from "react"
import { motion, AnimatePresence } from "framer-motion"
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { ScrollArea } from "@/components/ui/scroll-area"
import { Search } from "lucide-react"

interface EmojiPickerProps {
  onEmojiSelect: (emoji: string) => void
  isOpen: boolean
  onClose: () => void
}

const emojiCategories = {
  "Smileys & People": [
    "ðŸ˜€",
    "ðŸ˜ƒ",
    "ðŸ˜„",
    "ðŸ˜",
    "ðŸ˜†",
    "ðŸ˜…",
    "ðŸ˜‚",
    "ðŸ¤£",
    "ðŸ˜Š",
    "ðŸ˜‡",
    "ðŸ™‚",
    "ðŸ™ƒ",
    "ðŸ˜‰",
    "ðŸ˜Œ",
    "ðŸ˜",
    "ðŸ¥°",
    "ðŸ˜˜",
    "ðŸ˜—",
    "ðŸ˜™",
    "ðŸ˜š",
    "ðŸ˜‹",
    "ðŸ˜›",
    "ðŸ˜",
    "ðŸ˜œ",
    "ðŸ¤ª",
    "ðŸ¤¨",
    "ðŸ§",
    "ðŸ¤“",
    "ðŸ˜Ž",
    "ðŸ¤©",
    "ðŸ¥³",
  ],
  "Animals & Nature": [
    "ðŸ¶",
    "ðŸ±",
    "ðŸ­",
    "ðŸ¹",
    "ðŸ°",
    "ðŸ¦Š",
    "ðŸ»",
    "ðŸ¼",
    "ðŸ¨",
    "ðŸ¯",
    "ðŸ¦",
    "ðŸ®",
    "ðŸ·",
    "ðŸ½",
    "ðŸ¸",
    "ðŸµ",
    "ðŸ™ˆ",
    "ðŸ™‰",
    "ðŸ™Š",
    "ðŸ’",
    "ðŸ”",
    "ðŸ§",
    "ðŸ¦",
    "ðŸ¤",
    "ðŸ£",
    "ðŸ¥",
    "ðŸ¦†",
    "ðŸ¦…",
    "ðŸ¦‰",
    "ðŸ¦‡",
  ],
  "Food & Drink": [
    "ðŸŽ",
    "ðŸ",
    "ðŸŠ",
    "ðŸ‹",
    "ðŸŒ",
    "ðŸ‰",
    "ðŸ‡",
    "ðŸ“",
    "ðŸˆ",
    "ðŸ’",
    "ðŸ‘",
    "ðŸ¥­",
    "ðŸ",
    "ðŸ¥¥",
    "ðŸ¥",
    "ðŸ…",
    "ðŸ†",
    "ðŸ¥‘",
    "ðŸ¥¦",
    "ðŸ¥¬",
    "ðŸ¥’",
    "ðŸŒ¶ï¸",
    "ðŸŒ½",
    "ðŸ¥•",
    "ðŸ§„",
    "ðŸ§…",
    "ðŸ¥”",
    "ðŸ ",
    "ðŸ¥",
    "ðŸž",
  ],
  Activities: [
    "âš½",
    "ðŸ€",
    "ðŸˆ",
    "âš¾",
    "ðŸ¥Ž",
    "ðŸŽ¾",
    "ðŸ",
    "ðŸ‰",
    "ðŸ¥",
    "ðŸŽ±",
    "ðŸª€",
    "ðŸ“",
    "ðŸ¸",
    "ðŸ’",
    "ðŸ‘",
    "ðŸ¥",
    "ðŸ",
    "ðŸªƒ",
    "ðŸ¥…",
    "â›³",
    "ðŸª",
    "ðŸ¹",
    "ðŸŽ£",
    "ðŸ¤¿",
    "ðŸ¥Š",
    "ðŸ¥‹",
    "ðŸŽ½",
    "ðŸ›¹",
    "ðŸ›·",
    "â›¸ï¸",
  ],
  Objects: [
    "âŒš",
    "ðŸ“±",
    "ðŸ“²",
    "ðŸ’»",
    "âŒ¨ï¸",
    "ðŸ–¥ï¸",
    "ðŸ–¨ï¸",
    "ðŸ–±ï¸",
    "ðŸ–²ï¸",
    "ðŸ•¹ï¸",
    "ðŸ—œï¸",
    "ðŸ’½",
    "ðŸ’¾",
    "ðŸ’¿",
    "ðŸ“€",
    "ðŸ“¼",
    "ðŸ“·",
    "ðŸ“¸",
    "ðŸ“¹",
    "ðŸŽ¥",
    "ðŸ“½ï¸",
    "ðŸŽžï¸",
    "ðŸ“ž",
    "â˜Žï¸",
    "ðŸ“Ÿ",
    "ðŸ“ ",
    "ðŸ“º",
    "ðŸ“»",
    "ðŸŽ™ï¸",
    "ðŸŽšï¸",
  ],
}

export function EmojiPicker({ onEmojiSelect, isOpen, onClose }: EmojiPickerProps) {
  const [searchQuery, setSearchQuery] = useState("")
  const [selectedCategory, setSelectedCategory] = useState("Smileys & People")

  const filteredEmojis = searchQuery
    ? Object.values(emojiCategories)
        .flat()
        .filter((emoji) => emoji.includes(searchQuery.toLowerCase()))
    : emojiCategories[selectedCategory as keyof typeof emojiCategories]

  return (
    <AnimatePresence>
      {isOpen && (
        <motion.div
          initial={{ opacity: 0, y: 10, scale: 0.95 }}
          animate={{ opacity: 1, y: 0, scale: 1 }}
          exit={{ opacity: 0, y: 10, scale: 0.95 }}
          className="absolute bottom-full mb-2 right-0 w-80 bg-white/10 backdrop-blur-lg border border-white/20 rounded-lg shadow-xl z-50"
        >
          <div className="p-3 border-b border-white/10">
            <div className="relative">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" />
              <Input
                placeholder="Search emojis..."
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                className="pl-10 bg-white/10 border-white/20 text-white placeholder:text-gray-400"
              />
            </div>
          </div>

          {!searchQuery && (
            <div className="flex overflow-x-auto p-2 border-b border-white/10">
              {Object.keys(emojiCategories).map((category) => (
                <Button
                  key={category}
                  size="sm"
                  variant={selectedCategory === category ? "default" : "ghost"}
                  onClick={() => setSelectedCategory(category)}
                  className="whitespace-nowrap text-xs"
                >
                  {category.split(" ")[0]}
                </Button>
              ))}
            </div>
          )}

          <ScrollArea className="h-48 p-2">
            <div className="grid grid-cols-8 gap-1">
              {filteredEmojis.map((emoji, index) => (
                <Button
                  key={index}
                  variant="ghost"
                  size="sm"
                  className="h-8 w-8 p-0 hover:bg-white/20 text-lg"
                  onClick={() => {
                    onEmojiSelect(emoji)
                    onClose()
                  }}
                >
                  {emoji}
                </Button>
              ))}
            </div>
          </ScrollArea>
        </motion.div>
      )}
    </AnimatePresence>
  )
}
